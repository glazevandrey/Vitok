@using web_app.Models;
@using web_server.Models;
@model Dictionary<DateTime,List<StudentPayment>>;

@{
    Layout = "_Layout";
    User user = (User)ViewData["user"];
}
<style id="tableStyle" type="text/css">
    table {
        border-collapse: collapse;
    }

        table td, table th {
            border: 1px solid black;
        }

        table tr:first-child th {
            border-top: 0;
        }

        table tr:last-child td {
            border-bottom: 0;
        }

        table tr td:first-child,
        table tr th:first-child {
            border-left: 0;
        }

        table tr td:last-child,
        table tr th:last-child {
            border-right: 0;
        }

    thead,
    tfoot {
        background-color: #3f87a6;
        color: #fff;
    }

    tbody {
        background-color: #e4f0f5;
    }

    caption {
        padding: 10px;
        caption-side: bottom;
    }

    table {
        border-collapse: collapse;
        border: 2px solid rgb(200, 200, 200);
        letter-spacing: 1px;
        font-family: sans-serif;
        font-size: 0.8rem;
    }

    td,
    th {
        border: 1px solid rgb(190, 190, 190);
        padding: 5px 10px;
    }

    td {
        text-align: center;
    }


</style>
<div>
    <h2>Статистика студента</h2>
    <button onclick="printTable()">[Печать]</button>

</div>

<div id="tab2">
<link rel="stylesheet" href="~/table.css" media="print">
    <table class="table" id="myTable">
        <thead>
            <tr>
                <th>Дата оплаты</th>
                <th>Сумма оплаты</th>
                <th>Дата занятия</th>
                <th>Стоимость занятия</th>
                <th>Тип занятия</th>

            </tr>
        </thead>
        <tbody>

            @{
                foreach (var item in Model)
                {
                    foreach (var payment in item.Value)
                    {
                        <tr>

                            <td>
                                @{
                                    if (payment.PaymentDate != DateTime.MinValue)
                                    {
                                        @payment.PaymentDate.ToShortDateString()
                                    }
                                }

                            </td>


                            <td>
                                @{

                                    if (!string.IsNullOrEmpty(payment.PaymentAmount))
                                    {
                                        @payment.PaymentAmount
                                    }
                                }

                            </td>

                            <td>@payment.LessonDate.ToString("dd.MM.yyyy HH:mm")</td>
                            <td>@payment.LessonAmount</td>

                            @{
                                if (payment.LessonLooped)
                                {
                                    <td> Повторяющееся</td>
                                }
                                else
                                {
                                    <td>Разовое</td>
                                }
                            }

                        </tr>

                    }

                }
            }

        </tbody>
    </table>

</div>
<script type="text/javascript">
    function printTable() {
        const table = document.getElementById('myTable');
        const newWin = window.open('', 'Print-Window');
       
        newWin.document.body.innerHTML = table.outerHTML;
        newWin.focus();
        newWin.print();
        newWin.close();
    }
</script>
@using web_server.Models;
@using web_server.Models.DBModels;
@model List<Course>;
@{
    Layout = "_Layout";
}
<link rel="stylesheet" type="text/css" href="~/css/modal.css">

<style>


    label {
        display: block;
    }

        label > span {
            display: inline-block;
            width: 170px;
        }

        label > input {
            display: inline-block;
            width: 170px;
        }

    input#search {
        padding-left: 10px;
    }

    td, th {
        text-align: center;
    }

    td, tr, th {
        border: 1px solid #DBDBDB;
        font-size:32px;
        font-family: Poppins;
    }

    .th1 {
        width: 150px
    }


    @@media (min-width: 768px) {
        .th1 {
            width: 400px !important
        }
    }

    @@media (min-width: 1536px) {
        .div2 {
            margin-left: 400px !important
        }
    }

    @@media (min-width: 1920px) {
        .div2 {
            margin-left: 500px !important
        }
    }

    

    .th2 {
        width: 50px
    }
    /*  .updateForm{
            text-align:center;
        }

            .updateForm input {
            width:200px;
        }*/
</style>

<div class="div2" style="margin-left:500px">

    <div id="openModal" class="modal">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">
                    Добавить курс
                </h3>
                <a onclick="window.location.href='#'" title="Close" class="close">×</a>
            </div>
                <div class="modal-body" style="text-align:center">

                    <form method="post" style="font-size:20px" action="/courses/savenew">
        
                    <label>Название:</label>
                    <input style="width:300px" name="title" id="title" type="text" value=""/>
                    <br/>
                        <br />
                        <label>Цель:</label>

                        <select style="width:300px" name="goalId" id="goalId">
                        @foreach (Goal item in (List<Goal>)ViewData["goals"])
                        {
                            <option value="@item.Id">@item.Title</option>
                        }

                    </select>
                    <br />
                    <br />

                        <div style="text-align:center; padding-top:20px">
                            <button type="submit" class="u-btn u-btn-round u-button-style u-custom-color-2 u-radius-10" style="width:150px;color:white !important;display:inline-block;margin-bottom:0px;">
                                Сохранить
                            </button>
                            <button class="u-btn u-btn-round u-button-style u-custom-color-2 u-radius-10" style="width:150px; color:white !important;display:inline-block;margin-bottom:0px;" onclick="window.location.href='#'">
                                Отмена
                            </button>
                        </div>
                

                    <br />
                    <br />

                   </form>


            </div>
        </div>
    </div>
</div>

    <br />

    <div>
        <input type="text" id="search" style="border-radius: 10px; border: 1px solid gray; height:50px;width:500px;font-size:26px" placeholder="Поиск...">



        <button onclick="window.location.hash = '#openModal'" class="u-btn u-btn-round u-button-style u-custom-color-2 u-radius-10" style="font-size:20px;color:white !important;height:50px;width:500px">
            Добавить курс
        </button>
    </div>

   @* <input type="text" id="search" placeholder="Поиск...">
    <input type="button" value="Добавить курс" onclick="window.location.hash='#openModal'" />*@

    <br/>
    <table id="table" style="border-collapse:collapse">
        <thead>
            <tr>
                <th class="th1">Название</th>
                <th class="th2"></th>
                <th class="th2"></th>
            </tr>

        </thead>
        <tbody id="table-body">
            @foreach (var item in Model)
            {
                if (string.IsNullOrEmpty(item.Title))
                {
                    continue;
                }
                 <tr>
                    <td>
                    @item.Title
                    </td>

                    <td>
                        <img style="width:30px;height:30px;cursor:pointer" src="~/content/images/arrow-square-up.svg" onclick="openEdit('@item.Id', '@item.Title', '@item.Goal.Id')" />
                    </td>
                    <td>
                        <img style="width:30px;height:30px;cursor:pointer" src="~/content/images/arrow-square-up-1.svg" onclick="openRemove('@item.Id')" />
                    </td>

@*
                    <td>
                        <button onclick="openEdit('@item.Id', '@item.Title', '@item.Goal.Id')">Edit</button>
                    </td>
                    <td>
                        <button onclick="openRemove('@item.Id')">Remove</button>
                    </td>*@
                </tr>   
            
            }
        
         
        </tbody>
    </table>    
</div>
<div id="openRemoveModal" class="modal">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">
                    Подтвердите удаление курса из системы
                </h3>
                <a href="#closeRemoveModal" title="Close" class="close">×</a>
            </div>
            <div class="modal-body">
                <form method="post" action="/courses/removeCourse">
                    <input hidden="hidden" value="" id="courseId" name="courseId" />
                    <br />                    <br />

                    <input type="submit" value="Удалить"/>
                    <input type="button" value="Отмена" onclick="closeRemove()">
                </form>

            </div>
        </div>
    </div>
</div>

<div id="openEditModal" class="modal">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">
                    Изменение курса
                </h3>
                <a href="#closeEditModal" title="Close" class="close">×</a>
            </div>
            <div class="modal-body" style="text-align:center">
                <form method="post" action="/courses/editCourse" style="font-size:20px">
                    <input hidden="hidden" value="" id="courseIdEdit" name="courseIdEdit" />
                    <label>Название:</label>
                    <input value="" style="width:300px" id="courseTitle" name="courseTitle" />
                    <br /><br />
                    <label>Цель:</label>
                    <select name="goalEditId" style="width:300px" id="goalEditId">
        <option value=""></option>
        @foreach (Goal item in (List<Goal>)ViewData["goals"])
        {
            <option value="@item.Id">@item.Title</option>
        }

    </select>
                    <br /><br />

                    <div style="text-align:center; padding-top:20px">
                        <button type="submit" class="u-btn u-btn-round u-button-style u-custom-color-2 u-radius-10" style="width:150px;color:white !important;display:inline-block;margin-bottom:0px;">
                            Сохранить
                        </button>
                        <button class="u-btn u-btn-round u-button-style u-custom-color-2 u-radius-10" style="width:150px; color:white !important;display:inline-block;margin-bottom:0px;" onclick="closeEdit()">
                            Отмена
                        </button>
                    </div>
@*                    <input type="submit" value="Изменить"/>
                    <input type="button" value="Отмена" onclick="closeEdit()">*@
                </form>

            </div>
        </div>
    </div>
</div>
@{

    if(ViewData["error"] != null)
    {
        <script>alert('@ViewData["error"].ToString()')</script>
    }
}
<script>

    function closeRemove(){
        window.location.hash = "#closeRemoveModal";

    }
    function closeEdit() {
        window.location.hash = "#closeEditModal";

    }
    function openEdit(id, title, goal){
        document.getElementById('courseTitle').value = title;
        document.getElementById('goalEditId').value = goal; 
        document.getElementById('courseIdEdit').value = id;
        window.location.hash = "#openEditModal";

    }
    function openRemove(id) {
        document.getElementById('courseId').value = id;
        window.location.hash = "#openRemoveModal";
    }

    function searchTable() {
        var input, filter, table, tr, td, i, txtValue;
        input = document.getElementById("search");
        filter = input.value.toUpperCase();
        table = document.getElementById("table");
        tr = table.getElementsByTagName("tr");

        for (i = 0; i < tr.length; i++) {
            td = tr[i].getElementsByTagName("td");
            for (j = 0; j < td.length; j++) {
                txtValue = td[j].textContent || td[j].innerText;
                if (txtValue.toUpperCase().indexOf(filter) > -1) {
                    tr[i].style.display = "";
                    break;
                } else {
                    tr[i].style.display = "none";
                }
            }
        }
    }

    document.getElementById("search").onkeyup = searchTable;

</script>


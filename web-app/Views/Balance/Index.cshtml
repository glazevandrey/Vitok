@using web_server.Models;
@model User

@{
    Layout = "_Layout";
}

@{


    <script>

    function trial(){
                    document.getElementById('isTrialPay').value = true;
                       document.getElementById('count2').value = 1;
            document.getElementById('countView').value =  250;

}
        function clicked() {

        document.getElementById('count2').value++;
        document.getElementById('count2').onchange(document.getElementById('count2'));

        }
        function changed2(el) {

          
            document.getElementById('countView').value = el.value * 1000;

            
        }
        function selectChanged(el) {
                    document.getElementById('count2').value = el.value;
            document.getElementById('countView').value = el.value * 1000;
        }
    </script>
    if (Model.Role == "Tutor")
    {
        <div id="balance">
            <label>Ваш баланс: </label>
            <input disabled="disabled" id="balance_input" value="@Model.Balance" />
        </div>
    }
    else
    {
        <div id="count">
            <label>Осталось: </label>
            <input disabled="disabled" id="balance_input" value="@Model.LessonsCount занятий" />
        </div>

        <br/>
        <br />
        <div id="purchase">


            <form method="post" action="/balance/setLessons">
                <input hidden="hidden" name="userId" id="userId" value="@Model.UserId" />
                <input hidden="hidden" name="isTrialPay" id="isTrialPay" value="false" />

                <br />
                <br />
                                        <label>Добавить пробное занятие стоимостью 250 рублей:</label>

                @{

                    if(Model.UsedTrial == false)
                    {
                        <input value="Добавить" onclick="trial()" type="button" />
                       
                    }
                    else
                    {
                        <input disabled="disabled" value="Добавить" onclick="trial()" type="button" />

                    }
                    <br />
                    <br />

                }
                
              
                <label>Выберите пакет занятий:</label>
                <select onchange="selectChanged(this)">

                    @{
                        <option value="0"></option>

                        foreach (Tariff item in (List<Tariff>)ViewData["tariffs"])
                        {
                            <option value="@item.LessonsCount">@item.Title</option>
                        }
                    }

                </select>
                <br />
                <br />

                <label>Или</label>
                <br />
                <br />

                <label>Выберите количество занятий (вне пакета)</label>
                <input id="count2" onchange="changed2(this)" name="count" type="text" value="0" /><button type="button" style="width:50px;" onclick="clicked()">+</button>
        




        <br/>
        <br />
        <div>

            <label>С вас:</label><input style="width:100px;" id="countView" value="0" /><label> рублей</label>

        </div>
        <input type="submit" value="Пополнить счет"/>
        <br />
        <br />

            </form>
        </div>


    }
}

<br />
<br />
<div id="history">
    <label align="center">История</label>
    <br/>
@{
        if(Model.Role == "Tutor")
        {
            foreach (var item in Model.BalanceHistory.CashFlow)
            {
                <label><b>@item.Date.ToString("dd MMMM ddd")</b></label>
                <br/>
                <label>@item.Amount</label>
                <br/>
                <br/>
            }
        }
        else
        {
            foreach (var item in Model.BalanceHistory.CustomMessages)
            {
                        <label><b>@item.Key.ToString("dd MMMM ddd")</b></label>
                            <br/>
                        <label>@item.Value</label>
                            <br/>
                            <br/>
            }
        }
    }
    </div>